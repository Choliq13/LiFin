<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/ActivityRecord.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/ActivityRecord.kt" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.example.lifin.data.models&#10;&#10;import kotlinx.serialization.SerialName&#10;import kotlinx.serialization.Serializable&#10;&#10;@Serializable&#10;data class ActivityRecord(&#10;    @SerialName(&quot;activity_id&quot;) val id: Int? = null,&#10;    @SerialName(&quot;user_id&quot;) val userId: Int,&#10;    @SerialName(&quot;activity_name&quot;) val activityName: String?,&#10;    @SerialName(&quot;duration_minutes&quot;) val durationMinutes: Int?,&#10;    @SerialName(&quot;intensity&quot;) val intensity: String?,&#10;    @SerialName(&quot;created_at&quot;) val createdAt: String? = null&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/BloodGlucoseRecord.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/BloodGlucoseRecord.kt" />
              <option name="originalContent" value="&#10;" />
              <option name="updatedContent" value="package com.example.lifin.data.models&#10;&#10;import kotlinx.serialization.SerialName&#10;import kotlinx.serialization.Serializable&#10;&#10;@Serializable&#10;data class BloodGlucoseRecord(&#10;    @SerialName(&quot;gl_id&quot;) val id: Int? = null,&#10;    @SerialName(&quot;user_id&quot;) val userId: Int,&#10;    @SerialName(&quot;glucose_value&quot;) val glucoseValue: Double?,&#10;    @SerialName(&quot;created_at&quot;) val createdAt: String? = null&#10;)&#10;&#10;// deprecated - replaced by aggregated HealthNoteRecord" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/BloodPressureRecord.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/BloodPressureRecord.kt" />
              <option name="updatedContent" value="package com.example.lifin.data.models&#10;&#10;import kotlinx.serialization.SerialName&#10;import kotlinx.serialization.Serializable&#10;&#10;@Serializable&#10;data class BloodPressureRecord(&#10;    @SerialName(&quot;bp_id&quot;) val id: Int? = null,&#10;    @SerialName(&quot;user_id&quot;) val userId: Int,&#10;    @SerialName(&quot;bp_value&quot;) val bpValue: String?,&#10;    @SerialName(&quot;systolic&quot;) val systolic: Int?,&#10;    @SerialName(&quot;diastolic&quot;) val diastolic: Int?,&#10;    @SerialName(&quot;created_at&quot;) val createdAt: String? = null&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/HealthNoteRecord.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/HealthNoteRecord.kt" />
              <option name="updatedContent" value="package com.example.lifin.data.models&#10;&#10;import kotlinx.serialization.SerialName&#10;import kotlinx.serialization.Serializable&#10;&#10;@Serializable&#10;data class HealthNoteRecord(&#10;    @SerialName(&quot;id&quot;) val id: String? = null,&#10;    @SerialName(&quot;user_id&quot;) val userId: String,&#10;    @SerialName(&quot;weight_kg&quot;) val weightKg: Double?,&#10;    @SerialName(&quot;height_cm&quot;) val heightCm: Double?,&#10;    @SerialName(&quot;blood_pressure&quot;) val bloodPressure: String?,&#10;    @SerialName(&quot;blood_glucose&quot;) val bloodGlucose: Double?,&#10;    @SerialName(&quot;activity_minutes&quot;) val activityMinutes: Int?,&#10;    @SerialName(&quot;nutrition&quot;) val nutrition: String?,&#10;    @SerialName(&quot;created_at&quot;) val createdAt: String? = null&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/WeightHeightRecord.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lifin/data/models/WeightHeightRecord.kt" />
              <option name="updatedContent" value="package com.example.lifin.data.models&#10;&#10;import kotlinx.serialization.SerialName&#10;import kotlinx.serialization.Serializable&#10;&#10;@Serializable&#10;data class WeightHeightRecord(&#10;    @SerialName(&quot;wh_id&quot;) val id: Int? = null,&#10;    @SerialName(&quot;user_id&quot;) val userId: Int,&#10;    @SerialName(&quot;weight&quot;) val weight: Double?,&#10;    @SerialName(&quot;height&quot;) val height: Double?,&#10;    @SerialName(&quot;created_at&quot;) val createdAt: String? = null&#10;)" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lifin/ui/security/PinEntryScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lifin/ui/security/PinEntryScreen.kt" />
              <option name="originalContent" value="package com.example.lifin.ui.security&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.focus.FocusRequester&#10;import androidx.compose.ui.focus.focusRequester&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import androidx.compose.ui.input.key.onKeyEvent&#10;import androidx.compose.ui.text.input.ImeAction&#10;import androidx.compose.ui.text.input.KeyboardType&#10;import androidx.compose.foundation.text.KeyboardOptions&#10;import androidx.compose.foundation.text.KeyboardActions&#10;&#10;@Composable&#10;fun PinEntryScreen(&#10;    title: String = &quot;Masukan PIN&quot;,&#10;    subtitle: String = &quot;Masukkan 6 digit PIN Anda&quot;,&#10;    onPinComplete: (String) -&gt; Unit,&#10;    isError: Boolean = false,&#10;    onForgotPin: (() -&gt; Unit)? = null&#10;) {&#10;    val boxCount = 6&#10;    val digits = remember { mutableStateListOf(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;) }&#10;    val focusRequesters = remember { List(boxCount) { FocusRequester() } }&#10;    var localError by remember { mutableStateOf(isError) }&#10;&#10;    LaunchedEffect(isError) { localError = isError }&#10;&#10;    fun currentPin(): String = digits.joinToString(&quot;&quot;)&#10;&#10;    Box(&#10;        modifier = Modifier&#10;            .fillMaxSize()&#10;            .background(Color(0xFF1E1E1E)),&#10;        contentAlignment = Alignment.Center&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(horizontal = 24.dp, vertical = 32.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            Text(&#10;                text = title,&#10;                fontSize = 24.sp,&#10;                fontWeight = FontWeight.Bold,&#10;                color = Color.White&#10;            )&#10;            Spacer(Modifier.height(4.dp))&#10;            Text(&#10;                text = subtitle,&#10;                fontSize = 14.sp,&#10;                color = Color(0xFFB0B0B0)&#10;            )&#10;            Spacer(Modifier.height(28.dp))&#10;&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                verticalAlignment = Alignment.CenterVertically&#10;            ) {&#10;                repeat(boxCount) { index -&gt;&#10;                    val value = digits[index]&#10;                    OutlinedTextField(&#10;                        value = value,&#10;                        onValueChange = { ch -&gt;&#10;                            if (ch.length &lt;= 1 &amp;&amp; ch.all { it.isDigit() }) {&#10;                                digits[index] = ch&#10;                                if (ch.isNotEmpty()) {&#10;                                    if (index &lt; boxCount - 1) {&#10;                                        focusRequesters[index + 1].requestFocus()&#10;                                    } else {&#10;                                        if (currentPin().length == boxCount) onPinComplete(currentPin())&#10;                                    }&#10;                                }&#10;                            }&#10;                        },&#10;                        modifier = Modifier&#10;                            .weight(1f)&#10;                            .aspectRatio(1f)&#10;                            .focusRequester(focusRequesters[index])&#10;                            .onKeyEvent { e -&gt;&#10;                                val isBackspace = e.nativeKeyEvent.keyCode == android.view.KeyEvent.KEYCODE_DEL&#10;                                if (isBackspace) {&#10;                                    if (digits[index].isEmpty() &amp;&amp; index &gt; 0) {&#10;                                        digits[index - 1] = &quot;&quot;&#10;                                        focusRequesters[index - 1].requestFocus()&#10;                                    } else if (digits[index].isNotEmpty()) {&#10;                                        digits[index] = &quot;&quot;&#10;                                    }&#10;                                    true&#10;                                } else false&#10;                            },&#10;                        singleLine = true,&#10;                        textStyle = LocalTextStyle.current.copy(&#10;                            textAlign = TextAlign.Center,&#10;                            fontSize = 18.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            color = Color.White&#10;                        ),&#10;                        shape = RoundedCornerShape(10.dp),&#10;                        colors = OutlinedTextFieldDefaults.colors(&#10;                            focusedBorderColor = if (localError) Color.Red else Color(0xFF4CAF50),&#10;                            unfocusedBorderColor = if (localError) Color.Red else Color(0xFF3D3D3D),&#10;                            focusedContainerColor = Color(0xFF2C2C2C),&#10;                            unfocusedContainerColor = Color(0xFF2C2C2C),&#10;                            cursorColor = Color(0xFF4CAF50),&#10;                            focusedTextColor = Color.White,&#10;                            unfocusedTextColor = Color.White&#10;                        ),&#10;                        keyboardOptions = KeyboardOptions(&#10;                            keyboardType = KeyboardType.Number,&#10;                            imeAction = ImeAction.Next&#10;                        ),&#10;                        keyboardActions = KeyboardActions(onNext = {}),&#10;                        placeholder = {},&#10;                        isError = localError&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(Modifier.height(16.dp))&#10;&#10;            if (localError) {&#10;                Text(&#10;                    text = &quot;PIN salah, coba lagi&quot;,&#10;                    color = Color.Red,&#10;                    fontSize = 14.sp&#10;                )&#10;                Spacer(Modifier.height(12.dp))&#10;            }&#10;&#10;            // Backspace mass clear &amp; optional forgot PIN&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.SpaceBetween,&#10;                verticalAlignment = Alignment.CenterVertically&#10;            ) {&#10;                TextButton(onClick = {&#10;                    // Clear all digits&#10;                    for (i in 0 until boxCount) digits[i] = &quot;&quot;&#10;                    focusRequesters[0].requestFocus()&#10;                    localError = false&#10;                }) {&#10;                    Text(&quot;Hapus&quot;, color = Color.White, fontSize = 14.sp)&#10;                }&#10;                if (onForgotPin != null) {&#10;                    TextButton(onClick = onForgotPin) {&#10;                        Text(&quot;Lupa PIN?&quot;, color = Color(0xFF4CAF50), fontSize = 14.sp)&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.lifin.ui.security&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.focus.FocusRequester&#10;import androidx.compose.ui.focus.focusRequester&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import androidx.compose.ui.input.key.onKeyEvent&#10;import androidx.compose.ui.text.input.ImeAction&#10;import androidx.compose.ui.text.input.KeyboardType&#10;import androidx.compose.foundation.text.KeyboardOptions&#10;import androidx.compose.foundation.text.KeyboardActions&#10;&#10;@Composable&#10;fun PinEntryScreen(&#10;    title: String = &quot;Masukan PIN&quot;,&#10;    subtitle: String = &quot;Masukkan 6 digit PIN Anda&quot;,&#10;    onPinComplete: (String) -&gt; Unit,&#10;    isError: Boolean = false,&#10;    onForgotPin: (() -&gt; Unit)? = null&#10;) {&#10;    val boxCount = 6&#10;    val digits = remember { mutableStateListOf(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;) }&#10;    val focusRequesters = remember { List(boxCount) { FocusRequester() } }&#10;    var localError by remember { mutableStateOf(isError) }&#10;&#10;    LaunchedEffect(isError) { localError = isError }&#10;&#10;    fun currentPin(): String = digits.joinToString(&quot;&quot;)&#10;&#10;    Box(&#10;        modifier = Modifier&#10;            .fillMaxSize()&#10;            .background(Color(0xFF1E1E1E)),&#10;        contentAlignment = Alignment.Center&#10;    ) {&#10;        Column(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(horizontal = 24.dp, vertical = 32.dp),&#10;            horizontalAlignment = Alignment.CenterHorizontally&#10;        ) {&#10;            Text(&#10;                text = title,&#10;                fontSize = 24.sp,&#10;                fontWeight = FontWeight.Bold,&#10;                color = Color.White&#10;            )&#10;            Spacer(Modifier.height(4.dp))&#10;            Text(&#10;                text = subtitle,&#10;                fontSize = 14.sp,&#10;                color = Color(0xFFB0B0B0)&#10;            )&#10;            Spacer(Modifier.height(28.dp))&#10;&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                verticalAlignment = Alignment.CenterVertically&#10;            ) {&#10;                repeat(boxCount) { index -&gt;&#10;                    val value = digits[index]&#10;                    OutlinedTextField(&#10;                        value = value,&#10;                        onValueChange = { ch -&gt;&#10;                            if (ch.length &lt;= 1 &amp;&amp; ch.all { it.isDigit() }) {&#10;                                digits[index] = ch&#10;                                if (ch.isNotEmpty()) {&#10;                                    if (index &lt; boxCount - 1) {&#10;                                        focusRequesters[index + 1].requestFocus()&#10;                                    } else {&#10;                                        if (currentPin().length == boxCount) onPinComplete(currentPin())&#10;                                    }&#10;                                }&#10;                            }&#10;                        },&#10;                        modifier = Modifier&#10;                            .weight(1f)&#10;                            .height(80.dp)  // Fixed height&#10;                            .focusRequester(focusRequesters[index])&#10;                            .onKeyEvent { e -&gt;&#10;                                val isBackspace = e.nativeKeyEvent.keyCode == android.view.KeyEvent.KEYCODE_DEL&#10;                                if (isBackspace) {&#10;                                    if (digits[index].isEmpty() &amp;&amp; index &gt; 0) {&#10;                                        digits[index - 1] = &quot;&quot;&#10;                                        focusRequesters[index - 1].requestFocus()&#10;                                    } else if (digits[index].isNotEmpty()) {&#10;                                        digits[index] = &quot;&quot;&#10;                                    }&#10;                                    true&#10;                                } else false&#10;                            },&#10;                        singleLine = true,&#10;                        readOnly = false,&#10;                        maxLines = 1,&#10;                        textStyle = LocalTextStyle.current.copy(&#10;                            textAlign = TextAlign.Center,&#10;                            fontSize = 36.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            color = Color(0xFFFFFFFF)  // Putih terang untuk dark background&#10;                        ),&#10;                        shape = RoundedCornerShape(10.dp),&#10;                        colors = OutlinedTextFieldDefaults.colors(&#10;                            focusedBorderColor = if (localError) Color.Red else Color(0xFF4CAF50),&#10;                            unfocusedBorderColor = if (localError) Color.Red else Color(0xFF3D3D3D),&#10;                            focusedContainerColor = Color(0xFF2C2C2C),&#10;                            unfocusedContainerColor = Color(0xFF2C2C2C),&#10;                            cursorColor = Color(0xFF4CAF50),&#10;                            focusedTextColor = Color.White,&#10;                            unfocusedTextColor = Color.White&#10;                        ),&#10;                        keyboardOptions = KeyboardOptions(&#10;                            keyboardType = KeyboardType.Number,&#10;                            imeAction = ImeAction.Next&#10;                        ),&#10;                        keyboardActions = KeyboardActions(onNext = {}),&#10;                        placeholder = {},&#10;                        isError = localError&#10;                    )&#10;                }&#10;            }&#10;&#10;            Spacer(Modifier.height(16.dp))&#10;&#10;            if (localError) {&#10;                Text(&#10;                    text = &quot;PIN salah, coba lagi&quot;,&#10;                    color = Color.Red,&#10;                    fontSize = 14.sp&#10;                )&#10;                Spacer(Modifier.height(12.dp))&#10;            }&#10;&#10;            // Backspace mass clear &amp; optional forgot PIN&#10;            Row(&#10;                modifier = Modifier.fillMaxWidth(),&#10;                horizontalArrangement = Arrangement.SpaceBetween,&#10;                verticalAlignment = Alignment.CenterVertically&#10;            ) {&#10;                TextButton(onClick = {&#10;                    // Clear all digits&#10;                    for (i in 0 until boxCount) digits[i] = &quot;&quot;&#10;                    focusRequesters[0].requestFocus()&#10;                    localError = false&#10;                }) {&#10;                    Text(&quot;Hapus&quot;, color = Color.White, fontSize = 14.sp)&#10;                }&#10;                if (onForgotPin != null) {&#10;                    TextButton(onClick = onForgotPin) {&#10;                        Text(&quot;Lupa PIN?&quot;, color = Color(0xFF4CAF50), fontSize = 14.sp)&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/lifin/ui/security/SetPinScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/lifin/ui/security/SetPinScreen.kt" />
              <option name="originalContent" value="package com.example.lifin.ui.security&#10;&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.focus.FocusRequester&#10;import androidx.compose.ui.focus.focusRequester&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.input.key.onKeyEvent // added&#10;import androidx.compose.foundation.text.KeyboardOptions // added&#10;import androidx.compose.foundation.text.KeyboardActions // added&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.lifin.R&#10;import com.example.lifin.data.repository.PinRepository&#10;import kotlinx.coroutines.launch&#10;import androidx.compose.ui.text.input.ImeAction // added&#10;import androidx.compose.ui.text.input.KeyboardType // added&#10;&#10;enum class SetPinStep {&#10;    ENTER_PIN,&#10;    CONFIRM_PIN&#10;}&#10;&#10;@Composable&#10;fun SetPinScreen(&#10;    onPinSet: () -&gt; Unit&#10;) {&#10;    val context = LocalContext.current&#10;    val pinRepository = remember { PinRepository(context) }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    var step by remember { mutableStateOf(SetPinStep.ENTER_PIN) }&#10;    val boxCount = 6&#10;&#10;    // segmented states for both steps&#10;    val firstDigits = remember { mutableStateListOf(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;) }&#10;    val confirmDigits = remember { mutableStateListOf(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;) }&#10;    val firstFocus = remember { List(boxCount) { FocusRequester() } }&#10;    val confirmFocus = remember { List(boxCount) { FocusRequester() } }&#10;&#10;    var showError by remember { mutableStateOf(false) }&#10;    var errorMessage by remember { mutableStateOf&lt;String?&gt;(null) }&#10;&#10;    fun firstPin(): String = firstDigits.joinToString(&quot;&quot;)&#10;    fun confirmPin(): String = confirmDigits.joinToString(&quot;&quot;)&#10;&#10;    fun clearFirst() {&#10;        for (i in 0 until boxCount) firstDigits[i] = &quot;&quot;&#10;        firstFocus[0].requestFocus()&#10;    }&#10;    fun clearConfirm() {&#10;        for (i in 0 until boxCount) confirmDigits[i] = &quot;&quot;&#10;        confirmFocus[0].requestFocus()&#10;    }&#10;&#10;    fun proceedOrError() {&#10;        if (firstPin().length == boxCount) {&#10;            step = SetPinStep.CONFIRM_PIN&#10;            showError = false&#10;            errorMessage = null&#10;        } else {&#10;            showError = true&#10;            errorMessage = &quot;PIN harus 6 digit&quot;&#10;        }&#10;    }&#10;&#10;    fun finishIfValid() {&#10;        val f = firstPin()&#10;        val c = confirmPin()&#10;        if (c.length != boxCount) {&#10;            showError = true&#10;            errorMessage = &quot;PIN harus 6 digit&quot;&#10;            return&#10;        }&#10;        if (f == c) {&#10;            val result = pinRepository.setupPin(c)&#10;            result.onSuccess { onPinSet() }&#10;                .onFailure { error -&gt;&#10;                    errorMessage = error.message ?: &quot;Gagal menyimpan PIN&quot;&#10;                    showError = true&#10;                }&#10;        } else {&#10;            showError = true&#10;            errorMessage = &quot;PIN tidak cocok, coba lagi&quot;&#10;            scope.launch {&#10;                kotlinx.coroutines.delay(1500)&#10;                showError = false&#10;                errorMessage = null&#10;                step = SetPinStep.ENTER_PIN&#10;                clearFirst()&#10;                clearConfirm()&#10;            }&#10;        }&#10;    }&#10;&#10;    Box(&#10;        modifier = Modifier.fillMaxSize()&#10;    ) {&#10;        // Background Image&#10;        Image(&#10;            painter = painterResource(id = R.drawable.bgawal),&#10;            contentDescription = &quot;Background&quot;,&#10;            contentScale = ContentScale.Crop,&#10;            modifier = Modifier.fillMaxSize(),&#10;            alpha = 0.5f&#10;        )&#10;&#10;        // Centered card&#10;        Box(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(horizontal = 32.dp),&#10;            contentAlignment = Alignment.Center&#10;        ) {&#10;            Card(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .wrapContentHeight(),&#10;                shape = RoundedCornerShape(16.dp),&#10;                colors = CardDefaults.cardColors(&#10;                    containerColor = Color(0xFFF5F5F5).copy(alpha = 0.95f)&#10;                ),&#10;                elevation = CardDefaults.cardElevation(defaultElevation = 8.dp)&#10;            ) {&#10;                Column(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .padding(24.dp),&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    // Title&#10;                    Row(modifier = Modifier.fillMaxWidth()) {&#10;                        Text(&#10;                            text = if (step == SetPinStep.ENTER_PIN) &quot;Buat PIN&quot; else &quot;Konfirmasi PIN&quot;,&#10;                            fontSize = 18.sp,&#10;                            fontWeight = FontWeight.Medium,&#10;                            color = Color.Black&#10;                        )&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(12.dp))&#10;&#10;                    // Segmented PIN row for current step&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                        verticalAlignment = Alignment.CenterVertically&#10;                    ) {&#10;                        repeat(boxCount) { index -&gt;&#10;                            val value = if (step == SetPinStep.ENTER_PIN) firstDigits[index] else confirmDigits[index]&#10;                            val requester = if (step == SetPinStep.ENTER_PIN) firstFocus[index] else confirmFocus[index]&#10;                            PinDigitBox(&#10;                                value = value,&#10;                                onValueChange = { ch -&gt;&#10;                                    if (ch.length &lt;= 1 &amp;&amp; ch.all { it.isDigit() }) {&#10;                                        if (step == SetPinStep.ENTER_PIN) {&#10;                                            firstDigits[index] = ch&#10;                                            if (ch.isNotEmpty()) {&#10;                                                if (index &lt; boxCount - 1) firstFocus[index + 1].requestFocus() else proceedOrError()&#10;                                            }&#10;                                        } else {&#10;                                            confirmDigits[index] = ch&#10;                                            if (ch.isNotEmpty()) {&#10;                                                if (index &lt; boxCount - 1) confirmFocus[index + 1].requestFocus() else finishIfValid()&#10;                                            }&#10;                                        }&#10;                                    }&#10;                                },&#10;                                onBackspace = {&#10;                                    if (step == SetPinStep.ENTER_PIN) {&#10;                                        if (firstDigits[index].isEmpty() &amp;&amp; index &gt; 0) {&#10;                                            firstDigits[index - 1] = &quot;&quot;&#10;                                            firstFocus[index - 1].requestFocus()&#10;                                        } else if (firstDigits[index].isNotEmpty()) {&#10;                                            firstDigits[index] = &quot;&quot;&#10;                                        }&#10;                                    } else {&#10;                                        if (confirmDigits[index].isEmpty() &amp;&amp; index &gt; 0) {&#10;                                            confirmDigits[index - 1] = &quot;&quot;&#10;                                            confirmFocus[index - 1].requestFocus()&#10;                                        } else if (confirmDigits[index].isNotEmpty()) {&#10;                                            confirmDigits[index] = &quot;&quot;&#10;                                        }&#10;                                    }&#10;                                },&#10;                                focusRequester = requester,&#10;                                isError = showError&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    if (showError &amp;&amp; errorMessage != null) {&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;                        Text(&#10;                            text = errorMessage!!,&#10;                            color = Color.Red,&#10;                            fontSize = 12.sp,&#10;                            textAlign = TextAlign.Center&#10;                        )&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(12.dp))&#10;&#10;                    // Primary button&#10;                    Button(&#10;                        onClick = {&#10;                            if (step == SetPinStep.ENTER_PIN) proceedOrError() else finishIfValid()&#10;                        },&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .height(48.dp),&#10;                        colors = ButtonDefaults.buttonColors(&#10;                            containerColor = Color(0xFF738A45)&#10;                        ),&#10;                        shape = RoundedCornerShape(8.dp),&#10;                        enabled = if (step == SetPinStep.ENTER_PIN) firstPin().length == boxCount else confirmPin().length == boxCount&#10;                    ) {&#10;                        Text(&#10;                            text = if (step == SetPinStep.ENTER_PIN) &quot;Lanjutkan&quot; else &quot;Selesai&quot;,&#10;                            fontSize = 16.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            color = Color.White&#10;                        )&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    // Optional helper&#10;                    if (step == SetPinStep.CONFIRM_PIN) {&#10;                        Text(&#10;                            text = &quot;Ubah PIN?&quot;,&#10;                            color = Color(0xFF738A45),&#10;                            fontSize = 14.sp,&#10;                            modifier = Modifier.clickable {&#10;                                step = SetPinStep.ENTER_PIN&#10;                                clearConfirm()&#10;                                showError = false&#10;                                errorMessage = null&#10;                            }&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun RowScope.PinDigitBox(&#10;    value: String,&#10;    onValueChange: (String) -&gt; Unit,&#10;    onBackspace: () -&gt; Unit,&#10;    focusRequester: FocusRequester,&#10;    isError: Boolean&#10;) {&#10;    val borderColor = if (isError) Color.Red else Color(0xFF738A45)&#10;    OutlinedTextField(&#10;        value = value,&#10;        onValueChange = onValueChange,&#10;        modifier = Modifier&#10;            .weight(1f)&#10;            .aspectRatio(1f)&#10;            .focusRequester(focusRequester)&#10;            .onKeyEvent { evt -&gt;&#10;                val isBackspace = evt.nativeKeyEvent.keyCode == android.view.KeyEvent.KEYCODE_DEL&#10;                if (isBackspace) { onBackspace(); true } else false&#10;            },&#10;        singleLine = true,&#10;        textStyle = LocalTextStyle.current.copy(&#10;            textAlign = TextAlign.Center,&#10;            fontSize = 18.sp,&#10;            fontWeight = FontWeight.Bold&#10;        ),&#10;        shape = RoundedCornerShape(8.dp),&#10;        colors = OutlinedTextFieldDefaults.colors(&#10;            focusedBorderColor = borderColor,&#10;            unfocusedBorderColor = borderColor.copy(alpha = 0.6f),&#10;            focusedContainerColor = Color.White,&#10;            unfocusedContainerColor = Color.White,&#10;            cursorColor = Color(0xFF738A45),&#10;            focusedTextColor = Color.Black,&#10;            unfocusedTextColor = Color.Black&#10;        ),&#10;        keyboardOptions = KeyboardOptions(&#10;            keyboardType = KeyboardType.Number,&#10;            imeAction = ImeAction.Next&#10;        ),&#10;        keyboardActions = KeyboardActions(onNext = {}),&#10;        placeholder = {},&#10;        isError = isError&#10;    )&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.lifin.ui.security&#10;&#10;import androidx.compose.foundation.Image&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.focus.FocusRequester&#10;import androidx.compose.ui.focus.focusRequester&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.input.key.onKeyEvent // added&#10;import androidx.compose.foundation.text.KeyboardOptions // added&#10;import androidx.compose.foundation.text.KeyboardActions // added&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.ui.res.painterResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.text.style.TextAlign&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.unit.sp&#10;import com.example.lifin.R&#10;import com.example.lifin.data.repository.PinRepository&#10;import kotlinx.coroutines.launch&#10;import androidx.compose.ui.text.input.ImeAction // added&#10;import androidx.compose.ui.text.input.KeyboardType // added&#10;&#10;enum class SetPinStep {&#10;    ENTER_PIN,&#10;    CONFIRM_PIN&#10;}&#10;&#10;@Composable&#10;fun SetPinScreen(&#10;    onPinSet: () -&gt; Unit&#10;) {&#10;    val context = LocalContext.current&#10;    val pinRepository = remember { PinRepository(context) }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    var step by remember { mutableStateOf(SetPinStep.ENTER_PIN) }&#10;    val boxCount = 6&#10;&#10;    // segmented states for both steps&#10;    val firstDigits = remember { mutableStateListOf(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;) }&#10;    val confirmDigits = remember { mutableStateListOf(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;) }&#10;    val firstFocus = remember { List(boxCount) { FocusRequester() } }&#10;    val confirmFocus = remember { List(boxCount) { FocusRequester() } }&#10;&#10;    var showError by remember { mutableStateOf(false) }&#10;    var errorMessage by remember { mutableStateOf&lt;String?&gt;(null) }&#10;&#10;    fun firstPin(): String = firstDigits.joinToString(&quot;&quot;)&#10;    fun confirmPin(): String = confirmDigits.joinToString(&quot;&quot;)&#10;&#10;    fun clearFirst() {&#10;        for (i in 0 until boxCount) firstDigits[i] = &quot;&quot;&#10;        firstFocus[0].requestFocus()&#10;    }&#10;    fun clearConfirm() {&#10;        for (i in 0 until boxCount) confirmDigits[i] = &quot;&quot;&#10;        confirmFocus[0].requestFocus()&#10;    }&#10;&#10;    fun proceedOrError() {&#10;        if (firstPin().length == boxCount) {&#10;            step = SetPinStep.CONFIRM_PIN&#10;            showError = false&#10;            errorMessage = null&#10;        } else {&#10;            showError = true&#10;            errorMessage = &quot;PIN harus 6 digit&quot;&#10;        }&#10;    }&#10;&#10;    fun finishIfValid() {&#10;        val f = firstPin()&#10;        val c = confirmPin()&#10;        if (c.length != boxCount) {&#10;            showError = true&#10;            errorMessage = &quot;PIN harus 6 digit&quot;&#10;            return&#10;        }&#10;        if (f == c) {&#10;            val result = pinRepository.setupPin(c)&#10;            result.onSuccess { onPinSet() }&#10;                .onFailure { error -&gt;&#10;                    errorMessage = error.message ?: &quot;Gagal menyimpan PIN&quot;&#10;                    showError = true&#10;                }&#10;        } else {&#10;            showError = true&#10;            errorMessage = &quot;PIN tidak cocok, coba lagi&quot;&#10;            scope.launch {&#10;                kotlinx.coroutines.delay(1500)&#10;                showError = false&#10;                errorMessage = null&#10;                step = SetPinStep.ENTER_PIN&#10;                clearFirst()&#10;                clearConfirm()&#10;            }&#10;        }&#10;    }&#10;&#10;    Box(&#10;        modifier = Modifier.fillMaxSize()&#10;    ) {&#10;        // Background Image&#10;        Image(&#10;            painter = painterResource(id = R.drawable.bgawal),&#10;            contentDescription = &quot;Background&quot;,&#10;            contentScale = ContentScale.Crop,&#10;            modifier = Modifier.fillMaxSize(),&#10;            alpha = 0.5f&#10;        )&#10;&#10;        // Centered card&#10;        Box(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(horizontal = 32.dp),&#10;            contentAlignment = Alignment.Center&#10;        ) {&#10;            Card(&#10;                modifier = Modifier&#10;                    .fillMaxWidth()&#10;                    .wrapContentHeight(),&#10;                shape = RoundedCornerShape(16.dp),&#10;                colors = CardDefaults.cardColors(&#10;                    containerColor = Color(0xFFF5F5F5).copy(alpha = 0.95f)&#10;                ),&#10;                elevation = CardDefaults.cardElevation(defaultElevation = 8.dp)&#10;            ) {&#10;                Column(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .padding(24.dp),&#10;                    horizontalAlignment = Alignment.CenterHorizontally&#10;                ) {&#10;                    // Title&#10;                    Row(modifier = Modifier.fillMaxWidth()) {&#10;                        Text(&#10;                            text = if (step == SetPinStep.ENTER_PIN) &quot;Buat PIN&quot; else &quot;Konfirmasi PIN&quot;,&#10;                            fontSize = 18.sp,&#10;                            fontWeight = FontWeight.Medium,&#10;                            color = Color.Black&#10;                        )&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(12.dp))&#10;&#10;                    // Segmented PIN row for current step&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp),&#10;                        verticalAlignment = Alignment.CenterVertically&#10;                    ) {&#10;                        repeat(boxCount) { index -&gt;&#10;                            val value = if (step == SetPinStep.ENTER_PIN) firstDigits[index] else confirmDigits[index]&#10;                            val requester = if (step == SetPinStep.ENTER_PIN) firstFocus[index] else confirmFocus[index]&#10;                            PinDigitBox(&#10;                                value = value,&#10;                                onValueChange = { ch -&gt;&#10;                                    if (ch.length &lt;= 1 &amp;&amp; ch.all { it.isDigit() }) {&#10;                                        if (step == SetPinStep.ENTER_PIN) {&#10;                                            firstDigits[index] = ch&#10;                                            if (ch.isNotEmpty()) {&#10;                                                if (index &lt; boxCount - 1) firstFocus[index + 1].requestFocus() else proceedOrError()&#10;                                            }&#10;                                        } else {&#10;                                            confirmDigits[index] = ch&#10;                                            if (ch.isNotEmpty()) {&#10;                                                if (index &lt; boxCount - 1) confirmFocus[index + 1].requestFocus() else finishIfValid()&#10;                                            }&#10;                                        }&#10;                                    }&#10;                                },&#10;                                onBackspace = {&#10;                                    if (step == SetPinStep.ENTER_PIN) {&#10;                                        if (firstDigits[index].isEmpty() &amp;&amp; index &gt; 0) {&#10;                                            firstDigits[index - 1] = &quot;&quot;&#10;                                            firstFocus[index - 1].requestFocus()&#10;                                        } else if (firstDigits[index].isNotEmpty()) {&#10;                                            firstDigits[index] = &quot;&quot;&#10;                                        }&#10;                                    } else {&#10;                                        if (confirmDigits[index].isEmpty() &amp;&amp; index &gt; 0) {&#10;                                            confirmDigits[index - 1] = &quot;&quot;&#10;                                            confirmFocus[index - 1].requestFocus()&#10;                                        } else if (confirmDigits[index].isNotEmpty()) {&#10;                                            confirmDigits[index] = &quot;&quot;&#10;                                        }&#10;                                    }&#10;                                },&#10;                                focusRequester = requester,&#10;                                isError = showError&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    if (showError &amp;&amp; errorMessage != null) {&#10;                        Spacer(modifier = Modifier.height(8.dp))&#10;                        Text(&#10;                            text = errorMessage!!,&#10;                            color = Color.Red,&#10;                            fontSize = 12.sp,&#10;                            textAlign = TextAlign.Center&#10;                        )&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(12.dp))&#10;&#10;                    // Primary button&#10;                    Button(&#10;                        onClick = {&#10;                            if (step == SetPinStep.ENTER_PIN) proceedOrError() else finishIfValid()&#10;                        },&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .height(48.dp),&#10;                        colors = ButtonDefaults.buttonColors(&#10;                            containerColor = Color(0xFF738A45)&#10;                        ),&#10;                        shape = RoundedCornerShape(8.dp),&#10;                        enabled = if (step == SetPinStep.ENTER_PIN) firstPin().length == boxCount else confirmPin().length == boxCount&#10;                    ) {&#10;                        Text(&#10;                            text = if (step == SetPinStep.ENTER_PIN) &quot;Lanjutkan&quot; else &quot;Selesai&quot;,&#10;                            fontSize = 16.sp,&#10;                            fontWeight = FontWeight.Bold,&#10;                            color = Color.White&#10;                        )&#10;                    }&#10;&#10;                    Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                    // Optional helper&#10;                    if (step == SetPinStep.CONFIRM_PIN) {&#10;                        Text(&#10;                            text = &quot;Ubah PIN?&quot;,&#10;                            color = Color(0xFF738A45),&#10;                            fontSize = 14.sp,&#10;                            modifier = Modifier.clickable {&#10;                                step = SetPinStep.ENTER_PIN&#10;                                clearConfirm()&#10;                                showError = false&#10;                                errorMessage = null&#10;                            }&#10;                        )&#10;                    }&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun RowScope.PinDigitBox(&#10;    value: String,&#10;    onValueChange: (String) -&gt; Unit,&#10;    onBackspace: () -&gt; Unit,&#10;    focusRequester: FocusRequester,&#10;    isError: Boolean&#10;) {&#10;    val borderColor = if (isError) Color.Red else Color(0xFF738A45)&#10;    OutlinedTextField(&#10;        value = value,&#10;        onValueChange = onValueChange,&#10;        modifier = Modifier&#10;            .weight(1f)&#10;            .height(80.dp)  // Fixed height untuk konsistensi&#10;            .focusRequester(focusRequester)&#10;            .onKeyEvent { evt -&gt;&#10;                val isBackspace = evt.nativeKeyEvent.keyCode == android.view.KeyEvent.KEYCODE_DEL&#10;                if (isBackspace) { onBackspace(); true } else false&#10;            },&#10;        singleLine = true,&#10;        readOnly = false,&#10;        maxLines = 1,&#10;        textStyle = LocalTextStyle.current.copy(&#10;            textAlign = TextAlign.Center,&#10;            fontSize = 36.sp,&#10;            fontWeight = FontWeight.Bold,&#10;            color = Color(0xFF000000)  // Hitam pekat untuk visibility maksimal&#10;        ),&#10;        shape = RoundedCornerShape(8.dp),&#10;        colors = OutlinedTextFieldDefaults.colors(&#10;            focusedBorderColor = borderColor,&#10;            unfocusedBorderColor = borderColor.copy(alpha = 0.6f),&#10;            focusedContainerColor = Color.White,&#10;            unfocusedContainerColor = Color.White,&#10;            cursorColor = Color(0xFF738A45),&#10;            focusedTextColor = Color(0xFF000000),  // Hitam pekat&#10;            unfocusedTextColor = Color(0xFF000000)  // Hitam pekat&#10;        ),&#10;        keyboardOptions = KeyboardOptions(&#10;            keyboardType = KeyboardType.Number,&#10;            imeAction = ImeAction.Next&#10;        ),&#10;        keyboardActions = KeyboardActions(onNext = {}),&#10;        placeholder = {},&#10;        isError = isError&#10;    )&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>